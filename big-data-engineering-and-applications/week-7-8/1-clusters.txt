-- create cluster with hadoop/hive
 aws emr create-cluster --release-label emr-5.14.0 --applications Name=Hadoop Name=Hive Name=Pig --use-default-roles --ec2-attributes KeyName=kram --instance-type m5.xlarge
 
-- ssh into the cluster
aws emr ssh --cluster-id j-1RRQ6DLV1C4PI --key-pair-file .kram.pem

-- describe the cluster
aws emr describe-cluster --cluster-id j-38JKIRK31TFVK

-- download some data on the vm
wget https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/samples/features.zip

-- unzip features
unzup features.zip

-- check head
head features.txt

-- run hive
hive

-- in hive, create a table
CREATE TABLE hive_features ( feature_id BIGINT, feature_name STRING, feature_class STRING,state_alpha STRING,prim_lat_dec DOUBLE,prim_long_dec DOUBLE,elev_in_ft BIGINT)ROW FORMAT DELIMITEDFIELDS TERMINATED BY '|'LINES TERMINATED BY 'n';

-- load the data in hive
LOAD DATA LOCAL INPATH './features.txt' OVERWRITE INTO TABLE hive_features;

-- select the data we just input
SELECT state_alpha, COUNT(*) FROM hive_features GROUP BY state_alpha;

 -- copy data to DynamoDB
 First create a table on DynamoDB
	name: Features
	primaryKey: Id 
		dataType: Number
	Read Capacity Units: 10
	Write Capacity Units: 10

-- create external hive table as DynamoDB
CREATE EXTERNAL TABLE ddb_features(feature_id BIGINT, feature_name STRING, feature_class STRING, state_alpha STRING, prim_lat_dec DOUBLE, prim_long_dec DOUBLE, elev_in_ft BIGINT) STORED BY 'org.apache.hadoop.hive.dynamodb.DynamoDBStorageHandler'TBLPROPERTIES("dynamodb.table.name" = "features", "dynamodb.column.mapping" = "feature_id:id, feature_name: Name, feature_class:Class, state_alpha:State, prim_lat_dec:Latitude, prim_long_dec:Longitude, elev_in_ft:Elevation");