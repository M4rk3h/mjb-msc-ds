# install ubuntu in vm
# update & upgrade
sudo apt update && sudo apt upgrade -y

# install openssh
sudo apt install openssh-server gedit

# check ssh status
sudo systemctl status ssh

# change hostname
sudo nano /etc/hostname

# check hostname
sudo hostname

# set hosts
sudo nano /etc/hosts

# add vm ip and bdea-master
192.168.1.170	bdea-master
192.168.1.171	bdea-worker

# install JAVA
sudo apt install openjdk-8-jdk

# add to s/bin path variables
# JAVA
export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64/jre

# download hadoop
wget https://archive.apache.org/dist/hadoop/common/hadoop-3.2.2/hadoop-3.2.2.tar.gz

# extract hadoop
tar -xvf hadoop-3.2.2.tar.gz

# remove archive
rm hadoop-3.2.2.tar.gz

# move and rename hadoop
sudo mv hadoop-3.2.2 /usr/local/hadoop

# add to s/bin path variables
sudo nano ~/.bashrc
# HADOOP
export PATH=$PATH:/usr/local/hadoop/bin:/usr/local/hadoop/sbin
export CONF=/usr/local/hadoop/etc/hadoop

# source bash
source .bashrc

# CLONE VM HERE
# reset the mac address, leave it on dhcp

# can change to static ip below
sudo nano /etc/netplan/*tab*

network:
  version: 2
  renderer: networkd
  ethernets:
    enp0s3:
      dhcp4: no
      addresses:
        - 192.168.1.171/24 # ip which you know if free
      gateway4: 192.168.1.254 # your router ip here
      nameservers:
          addresses: [8.8.8.8, 1.1.1.1]

sudo netplan apply

# generate ssh keys
ssh-keygen -t rsa

# copy master key (public) to worker
ssh-copy-id mark@bdea-master

# after configuring the 4 files on masters, copy to worker node
scp $CONF/* mark@bdea-worker:/usr/local/hadoop/etc/hadoop

# add more extries to bdea-master .bashrc
# HADOOP MAPPING
export HADOOP_HOME=/home/ubuntu/hadoop
export HADOOP_COMMON_HOME=$HADOOP_HOME/etc/hadoop
export HADOOP_CONF_DIR=HADOOP_HOME/etc/hadoop
export HADOOP_HDFS_HOME=$HADOOP_HOME
export HADOOP_MAPPED_HOME=$HADOOP_HOME