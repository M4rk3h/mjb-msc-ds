library(magrittr)
# generate white noise
set.seed(20210113)
(wn <- rnorm(100, sd = 10))
wn %>% plot(type = 'l')
# generate time vector
t <- 1:length(wn)
# linear trend
linear <- 2 + 3*t
linear.wn <- linear + wn
linear.wn %>% plot(type = 'l')
linear %>% lines(col = "red")
# quadratic trend
quadratic <- 25 - t + 0.01 * t^2
quadratic.wn <- quadratic + wn
quadratic.wn %>% plot(type = 'l')
quadratic %>% lines(col = "red")
# cubic trend
cubic <- - 7.55755 + 8.78074 * t - 0.224666 * t^2 + 0.00147614 * t^3
cubic.wn <- cubic + wn
cubic.wn %>% plot(type = 'l')
cubic %>% lines(col = "red")
# ------------------------------
# Average Atlanta Temperature
# ------------------------------
data <- read.table("data/AvTempAtlanta.txt", header = TRUE)
data %>% head()
data[,2:13] %>% head()
data[,-c(1,14)] %>% head()
temp <- as.vector(t(data[,-c(1,14)]))
data[,-c(1,14)] %>%
t() %>%
as.vector() -> temp
# plot the time series
temp %>% plot(type = 'l', ylab = "Average Atlanta Temperature")
temp[1:12] %>% plot(type = 'l', ylab = "Average Atlanta Temperature")
temp <- (temp - 32) * 5/9
temp %>% plot(type = 'l', ylab = "Average Atlanta Temperature")
# let's create a time series objoect
temp <- ts(temp, start = 1879, frequency = 12)
temp %>% ts(start = 1879, frequency = 12) -> temp
temp %>% plot()
temp %>% plot()
# mean
(avg <- mean(temp))
# time vector
time <- 1:length(temp)
time
# estimate linear trend
linear.fit <- lm(temp ~ time)
summary(linear.fit)
# time vector
time <- 1:length(temp)
# estimate linear trend
linear.fit <- lm(temp ~ time)
summary(linear.fit)
# time vector rescaled (0 first obs, 1 is the last)
time <- 1:length(temp)
time <- (time - min(time))/(max(time) - 1)
linear.fit <- lm(temp ~ time)
summary(linear.fit)
# time vector rescaled (0 first obs, 1 is the last)
time <- 1:length(temp)
time <- time/12
linear.fit <- lm(temp ~ time)
summary(linear.fit)
ts.plot(temp, ylab = "Temperature")
temp[1:12] %>% plot(type = 'l', ylab = "Average Atlanta Temperature")
temp <- (temp - 32) * 5/9
temp %>% plot(type = 'l', ylab = "Average Atlanta Temperature")
# let's create a time series objoect
temp <- ts(temp, start = 1879, frequency = 12)
temp %>% ts(start = 1879, frequency = 12) -> temp
temp %>% plot()
