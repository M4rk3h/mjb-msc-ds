"0","# create a function that accepts as arguments a time series dataset"
"0","# and the kind of model that we want to create (linear, quadratic, cubic,...)"
"0","# and gives as output the model with given parameters"
"0","create.model <- function(timeseries, degree) {"
"0","  # degree vector"
"0","  degree.vect = c(1,2,3)"
"0","  # create a switch case"
"0","  degree.value <- switch(degree,"
"0","                         linear    = degree.vect[1],"
"0","                         quadratic = degree.vect[2],"
"0","                         cubic     = degree.vect[3])"
"0","  # "
"0","  c(timeseries,"
"0","    c(""poly(time,"","
"0","      as.character(degree.value),"
"0","      "", raw = TRUE)"") %>% paste(collapse = """")) %>%"
"0","    paste(collapse = "" ~ "") %>%"
"0","    as.formula() %>%"
"0","    lm() -> model"
"0","  # return "
"0","  return(model %>% fitted())"
"0","}"
